/*! Utterfare 2018-05-21 09:05:54 */
function setImage(a){var b=$("input[name=itemImage]"),c=$("."+a+" input[name=itemImage]").prop("files")[0];$(b).val(),document.getElementsByClassName("item-image");if(c){var d=new FileReader;d.onload=function(b){$("."+a+" .item-image").attr("src",b.target.result)},d.readAsDataURL(c)}return!1}function uploadMenuItems(){return $("#fileupload").trigger("click"),$("#fileupload").change(function(){var a=$(this)[0].files[0];a&&saveMenuItems(a)}),!1}function saveMenuItems(a){var b=new FormData;b.append("action","uploadMenuFile"),b.append("file",a),$.ajax({url:"includes/php/AddEditItems.php",data:b,cache:!1,contentType:!1,processData:!1,method:"post",success:function(a){var b=JSON.parse(a);b.Existing&&(showInformationSnackbar("Items already exist",1e4,"OK"),$.each(b.Existing,function(a,b){$(".error-message").append('<p class="error-text">'+b+" already exists. Try adding an item with a different name or manually enter the item.</p>")})),b.Error&&showInformationSnackbar("Error uploading Items",1e4,"OK"),b.Success&&(showInformationSnackbar("Items sucessfully uploaded",1e4,"OK"),window.location.reload())},error:function(a){console.log("Error: "),console.log(a)}})}function showInformationSnackbar(a,b,c){var d=document.querySelector(".mdl-js-snackbar"),e={message:a,actionHandler:function(a){},actionText:c,timeout:b};d.MaterialSnackbar.showSnackbar(e)}function editItem(a){var b=$("."+a+"-item-name").html(),c=$("."+a+"-item-description").html();return $("."+a).removeAttr("onclick"),$("."+a+"-item-image").append("<input type='file' name='itemImage' value='"+b+"' accept='.png,.jpg,.jpeg,.gif'  onchange='return setImage("+a+");'/>"),$("."+a+"-item-name").html("<input type='text' name='itemName' value='"+b+"' class='itemNameInput'/>"),$("."+a+"-item-description").html("<textarea cols='30' name='itemDescription' class='itemDescriptionInput'>"+c+"</textarea>"),$("."+a).append("<td class='actions'><button onclick='return applyChanges("+a+")'><i class='glyphicon glyphicon-check'></i>Apply</button><br/><button onclick='return deleteItem("+a+")'><i class='glyphicon glyphicon-trash'></i>Delete</button></td>"),!1}function deleteItem(a){if(1==confirm("Are you sure you want to delete that item? This action cannot be undone.")){var b={action:"deleteItem",itemId:a};$.ajax({data:b,url:"includes/php/AddEditItems.php",method:"post",success:function(a){1==a?(getItems(),showSnackbar("Item Successfully Deleted","long")):showSnackbar("Error Removing Item","long")},error:function(a){showSnackbar("Error removing item.","short")}})}}function applyChanges(a){var b=$("input[name='itemImage']").prop("files")[0],c=$('input[name="itemName"]').val(),d=$('textarea[name="itemDescription"]').val(),e={action:"updateItem",ID:a,itemName:c,itemDescription:d};return $.ajax({data:e,url:"includes/php/AddEditItems.php",type:"post",success:function(c){null!==b&&(uploadImage(a,b),showSnackbar("Changes Saved","short"))}}),!1}function getItems(){this.ppp=$("select[name='limit']").val();var a={action:"getItems",limit:ppp,offset:this.offset};$.ajax({url:"includes/php/AddEditItems.php",data:a,method:"post",success:function(a){$(".currentItems__body").html(a),getPagination()}})}function getPagination(){var a={action:"pagination",itemsPerPage:$('select[name="limit"]').val()};$.ajax({data:a,url:"includes/php/AddEditItems.php",method:"POST",success:function(a){$(".table-footer__pagination").html(a)}})}function saveChanges(){var a=[];$(".newItem").each(function(b,c){var d=[];d.ITEM_IMAGE=$(c).find(".item-image").prop("files")[0],d.ITEM_NAME=$(c).find(".item-name").val(),d.ITEM_DESCRIPTION=$(c).find(".item-description").val(),a.push(d)});for(var b=0;b<a.length;b++){var c=a[b],d={action:"addNewItem",itemName:c.ITEM_NAME,itemDescription:c.ITEM_DESCRIPTION};$.ajax({url:"includes/php/AddEditItems.php",data:d,type:"post",success:function(a,b,d){null!=c.ITEM_IMAGE&&uploadImage(a,c.ITEM_IMAGE),getItems()},error:function(a){console.log(a)}})}}function uploadImage(a,b){var c=new FormData;c.append("action","addImage"),c.append("itemID",a),c.append("itemImage",b),$.ajax({url:"includes/php/AddEditItems.php",data:c,cache:!1,contentType:!1,processData:!1,method:"post",success:function(a){getItems()}})}function addItem(a){$(".currentItems__body").prepend("<tr class='newItem' id='"+a+"'><td><input type='file' name='item_image' class='item-image' accept='.png,.jpg,.jpeg,.gif' onchange='return setImage("+a+");'/></td><td><input type='text' name='item_name' class='item-name'/></td><td><textarea name='item_description' class='item-description'></textarea></td></tr>")}function getPage(a){this.offset=this.ppp*(a-1);var b={action:"getItems",limit:ppp,offset:offset};$.ajax({url:"includes/php/AddEditItems.php",data:b,method:"post",success:function(b){$(".currentItems__body").html(b),getPagination();var c=window.location.protocol+"//"+window.location.host+window.location.pathname+"?page="+a;window.history.pushState({path:c},"",c)}})}function recaptchaChecked(){$(".next--submit-form").fadeIn("fast")}function navigationButtons(){$(".next--contact-information").hide(),$(".next--company-information").hide(),$(".next--submit-form").hide(),$(".registrationPageLink").click(function(a){a.preventDefault()})}function goToPage(){$(".registrationForm button").click(function(){var a=$(this).data("page"),b=null,c=null;if($(".registrationForm>fieldset").each(function(){var a=$(this).attr("id");$("#"+a).is(":visible")&&(b=a)}),"confirm"===a)return $(".registrationForm").hide(),$(".loader>i").after("<h2>Loading...</h2>"),$(".loader").show(),registerCompany(),!1;if("next"===a){c=$("fieldset:visible").next().attr("data-page");var d=$("#"+b).next();$("#"+b).hide(),$(d[0]).fadeIn("slow"),$(".page-count--page-number").removeClass("active"),$(".page-count--page-number[data-page="+c+"]").addClass("active")}else{c=$("fieldset:visible").prev().attr("data-page");var e=$("#"+b).prev();$("#"+b).hide(),$(e[0]).fadeIn("slow"),$(".page-count--page-number").removeClass("active"),$(".page-count--page-number[data-page="+c+"]").addClass("active")}})}function pages(){$(".page-count--page-number>a").click(function(a){a.preventDefault(),$(this).parent().addClass("active");var b=$(this).attr("href");$(b).attr("id");$(".page-count--page-number").removeClass("active"),$(this).parent().addClass("active"),$(b).attr("active","true"),$("fieldset").each(function(){$(this).attr("id")!==$(b).attr("id")&&$(this).attr("active","false"),"true"==$(this).attr("active")?$(this).fadeIn("slow"):$(this).hide()})})}function keylisteners(){$("form[name=registrationForm]")&&($("input[name=username]").keyup(function(){validateUsername($(this).val())}),$(".mdl-textfield__input[name=password]").keyup(function(){$(this).val().length>=8?($(this).css("outline","2px solid green"),$(this).css("border-bottom","2px solid green")):($(this).css("outline","2px solid red"),$(this).css("border-bottom","2px solid red"))}),$(".mdl-textfield__input[name=confirm_password]").keyup(function(){$(this).val()===$(".mdl-textfield__input[name=password]").val()?($(".next--contact-information").fadeIn("fast"),$(this).css("outline","2px solid green"),$(this).css("border-bottom","2px solid green")):($(".next--contact-information").fadeOut("fast"),$(this).css("outline","2px solid red"),$(this).css("border-bottom","2px solid red"))}),$("input[name=company_name]").keyup(function(){$(this).val().length>0?$(".next--company-information").fadeIn("fast"):$(".next--company-information").hide()}))}function setRegistrationPages(a){for(i=1;i<=a;i++){var b=$("fieldset[data-page="+i+"]"),c=$(b).attr("id");$(".page-count").append("<div class='page-count--page-number page-"+i+"' data-page='"+i+"'><a class='registrationPageLink' href='#"+c+"'>"+i+"</div>"),i>1&&i<3&&$(".page-count--page-number").append("<span class='page-count--page-separator'></span>")}location.search;if("true"==$("#contactInformation").attr("active"))$(".page-2").addClass("active");else if("true"==$("#companyInformation").attr("active")){$(".page-count--page-number").data("page",3);$(".page-3").addClass("active")}else{$(".page-count--page-number").data("page",1);$(".page-1").addClass("active")}}function validatePassword(){var a=$("input[name='password']"),b=$("input[name='confirm_password']"),c=$("button[type='submit']");a.val().length<4?$(a).css("outline","1px solid red"):($(a).css("outline","1px solid green"),a.val()!==b.val()?$(b).css("outline","1px solid red"):($(b).css("outline","1px solid green"),$(c).attr("disabled",!1)))}function registerCompany(){var a="action=registerNewVendor";return a+="&"+$('form[name="registrationform"]').serialize(),$.ajax({data:a,url:"includes/php/VendorRegistration.php",method:"post",success:function(a){"success"===a?window.location.href="userHome.php":"exists"===a?window.location.href="userHome.php":console.log("Response: "+a)}}),!1}function registrationNotification(a){var b="action=registrationNotification";b+="&email="+a,$.ajax({data:b,url:"includes/php/VendorRegistration.php",method:"post",success:function(a){a?($(".next--contact-information").is(":enabled"),$("input[name=username]").css("outline","green solid 1px")):($(".next--contact-information").is(":disabled"),$("input[name=username]").css("outline","red solid 1px"))},error:function(a){console.log(a)}})}function validateUsername(a){var b=$('input[name="username"]'),c=$("button[type='submit']"),d={action:"validateUsername",username:a};$.ajax({data:d,url:"includes/php/VendorRegistration.php",method:"post",success:function(a){0==a?($(b).css("outline","1px solid red"),$(c).attr("disabled",!0)):($(b).css("outline","1px solid green"),$(c).attr("disabled",!1))}})}function validateLoginForm(){console.log("validatingForm");var a=$("input[name='username']").val(),b=$("input[name='password']").val(),c=new Array;return""===a||null===a||a.length<5?c.username=!1:c.username=!0,""===b||null===b||b.length<8?c.password=!1:c.password=!0,!1===c.username||!1===c.password?($("input[name='username']").css("outline","1px solid red"),$("input[name='username']").css("border","1px solid red"),$("label[for='username']").css("color","red"),$("input[name='password']").css("outline","1px solid red"),$("input[name='password']").css("border","1px solid red"),$("label[for='password']").css("color","red")):(console.log("signing in"),signIn()),!1}function signIn(){var a=$('form[name="loginForm"]').serialize();a+="&action=sign_in",console.log(a),$.ajax({url:"includes/php/UserLogIn.php",data:a,method:"post",success:function(a){console.log(a),"success"===a?window.location="userHome.php":console.log("Results: "+a)},error:function(a){console.log("error")}})}function signOut(){var a={action:"sign_out"};return $.ajax({url:"includes/php/UserLogIn.php",data:a,method:"post",success:function(a){console.log(a),a&&(window.location="login")}}),!0}function getCompanyInformation(){}function updateCompanyInformation(){var a="action=updateCompanyInformation&";return a+=$("form[name='companyInformation']").serialize(),$.ajax({data:a,method:"post",url:"includes/php/CompanyInformation.php",success:function(a){console.log(a),1==a?showSnackbar("Company Information Updated","long"):showSnackbar("Error: Company Information Was Not Updated","short")},error:function(a){showSnackbar("Error: Company Information Was Not Updated","short")}}),!1}function updateProfilePicture(){var a=$(".profile-picture__upload").prop("files")[0],b=new FormData;return b.append("action","updateProfilePicture"),b.append("picture",a),console.log(a),$.ajax({data:b,type:"post",url:"includes/php/CompanyInformation.php",cache:!1,contentType:!1,processData:!1,success:function(a){$(".profile-picture").attr("src",a+"?ver="+String(Math.random())),$(".profile-picture").css("background-color","transparent"),$(".profile-picture__upload").val(""),showSnackbar("Image successfully uploaded.","long")},error:function(a){showSnackbar("Error uploading image","long")}}),!1}function showSnackbar(a,b){b="long"==b?5e3:"short"==b?3e3:5e3;var c=document.getElementById("snackbar");c.className="show",c.innerHTML=a,setTimeout(function(){c.className=c.className.replace("show")},b),console.log("the watch worked")}function validateInput(a,b){a.match(/\d+/g),a.match(/^[a-zA-Z\s]+$/);inputValid()}function inputNotValid(){$(".locationInput").css("border","1px solid red"),$(".locationInput").css("outline","1px solid red"),$(".search").prop("disabled",!0)}function inputValid(){$(".locationInput").css("border","1px solid green"),$(".locationInput").css("outline","1px solid green"),$(".search").prop("disabled",!1)}function isNumeric(a){return!isNaN(parseFloat(a))&&isFinite(a)}function geolocation(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(showPosition)}function showPosition(a){codeLatLng(a.coords.latitude,a.coords.longitude)}function codeLatLng(a,b){var c=new google.maps.Geocoder,d=new google.maps.LatLng(a,b);c.geocode({latLng:d},function(a,b){b===google.maps.GeocoderStatus.OK&&a[0]&&($(".locationLink").html("<i class='fa fa-map-marker' aria-hidden='true'></i>"+a[0].formatted_address),$(".locationLink").attr("data-location",a[0].formatted_address))})}function changeLocation(){$(".locationInput").show(),$(".locationLink").hide();var a=$(".locationLink").text().split(","),b=a[1],b=b.split(" ");$(".locationInput").val(a[0]+", "+b[1])}function sendEmail(){var a=$(".contact-form").serialize();return $.ajax({url:"includes/php/contact.php",data:a,method:"post",success:function(a){console.log(a),$(".contact-form").hide(),$(".confirmation").html('<h2 class="confirmation-message">Your email has been received. We will respond within 72 hours.</h2>'),setTimeout(function(){$(".confirmation").hide(),$(".contact-form").show()},2e3)},error:function(a){$(".confirmation").html('<h2 class="error-message">There was an error sending your message. Please try again.</h2>')}}),!1}function topTermsChart(){var a={action:"getTermsData"};$.ajax({data:a,method:"post",url:"includes/php/SearchAnalytics.php",success:function(a){drawChart("topTermsChart","Top 5 Search Terms","doughnut",a)},error:function(){console.log("error")}})}function searchCountChart(){var a={action:"getSearchCount"};$.ajax({data:a,method:"post",url:"includes/php/SearchAnalytics.php",success:function(a){drawChart("searchCountChart","Search Appearances","line",a)},error:function(){console.log("error")}})}function platformChart(){var a={action:"get_platforms"};$.ajax({data:a,method:"post",url:"includes/php/SearchAnalytics.php",success:function(a){drawChart("searchPlatformChart","Searches by Platform","bar",a)}})}function drawChart(a,b,c,d){var e=[],f=[],g=0;$.each(JSON.parse(d),function(a,b){e.push(a),f.push(parseInt(b)),g+=b});var h=null,i=null,j=null;"bar"===c||"line"===c?(j="rgba(2,136,209,1.0)",h=!1,i={title:{display:!0,text:b,fontSize:24},responsive:!0,scales:{yAxes:[{display:!0,ticks:{suggestedMin:0,steps:.5}}]}}):"doughnut"===c&&(j="rgba(0,0,0,0)",i={title:{display:!0,text:b,fontSize:24},responsive:!0});var k=$("#"+a),l=new Chart(k,{type:c,data:{labels:e,datasets:[{label:b,data:f,fill:h,borderColor:j,backgroundColor:["rgba(2,136,209, 1.0)","rgba(2,136,209, 0.80)","rgba(2,136,209, 0.60)","rgba(2,136,209, 0.40)","rgba(2,136,209, 0.20)"]}]},options:i});0===l.data.datasets[0].data.length&&Chart.plugins.register({afterDraw:function(a){k=l.chart.ctx;var b=l.chart.width,c=l.chart.height;k.save(),k.textAlign="center",k.textBaseline="middle",k.font="16px normal 'Helvetica Nueue'",k.canvas.title=l.options.title.text,k.fillText("No data to display",b/2,c/2)}})}function authorized(a,b,c){return""!==a&&null!==a&&(!(""===b||null===b||b.length<5)&&(""!==c&&null!==c))}function formSearch(){var a=this.limit,b=this.page,c=this.offset,d=$(".searchInput").val(),e=null;e=$(".locationLink").is(":visible")?$(".locationLink").data("location"):$(".locationInput").val();var f=$(".distance").val();return!0===authorized(d,e,f)?(e=getLatLng(e),performSearch(d,e,f,b,a,c)):$(".results").html("Please be sure to fill out the location, distance, and search parameters"),!1}function performSearch(a,b,c,d,e,f){$(".loader").show();var g={location:b,terms:a,limit:e,page:d,distance:c,offset:f};$.ajax({url:"includes/php/search.php",data:g,method:"post",success:function(a){$(".loader").hide(),"No Results"!==a?($(".results").append(a),$(".page-title").hide(),$(".navbar-normal").show(),$(".navbar-presearch").hide(),$(".loadmore-button").show()):$(".results").html("We're afraid that nothing was returned for your search. Please try something else!")},error:function(a,b,c){$(".loader").hide()}})}function loadMore(){this.page+=1;var a=this.limit*this.page,b=this.limit,c=$(".searchInput").val(),d=null;d=$(".locationLink").is(":visible")?$(".locationLink").data("location"):$(".locationInput").val(),performSearch(c,d,$(".distance").val(),page,b,a)}function getLatLng(a){var b=new google.maps.Geocoder,c=a;return b.geocode({address:a},function(a,b){if("OK"===b){var d=a[0].geometry.location.latitude,e=a[0].geometry.location.longitude;c=d+"+"+e}}),c}function submitSurvey(){var a=$(".survey-form").serialize();return a+="&action=new_user_survey",console.log(a),$.ajax({data:a,url:"includes/php/UserData.php",method:"post",success:function(a){$(".survey-form").fadeOut("fast",function(){$(".message").text("Thank you for taking this survey."),$(".message").fadeIn()})},error:function(a){console.log(a)}}),!1}var offset="0",page="1",ppp=null;$(document).ready(function(){var a=window.location.pathname,b=1;"/addEditItems.php"!=a&&"/addEditItems"!=a&&"/utterfare/addEditItems"!=a||getItems(),$(".addItemButton").on("click",function(){addItem(b++)}),$(".saveChangesButton").on("click",function(){saveChanges()})}),$(window).on("load",function(){var a=window.location.search;if(a){getPage(a.split("=")[1])}}),$(document).ready(function(){if(document.getElementsByClassName("registrationForm")){setRegistrationPages($(".registrationForm>fieldset").length)}$("#contactInformation").hide(),$("#companyInformation").hide(),$("select[name='state']").select2({width:"100%",placeholder:"Select a state",allowClear:!1}),$("select[name='country']").select2({width:"100%",placeholder:"Select a country"}),$("select[name='web-prefix']").select2({width:"fit-content"}),$("select[name='role']").select2({width:"100%",placeholder:"Role",alowClear:!1}),$("input[name=phone]").keydown(function(){$(this).val($(this).val().replace(/[^0-9\(\)\-]/g,""))}),$("input[name=phone]").keyup(function(){$(this).val($(this).val().replace(/^(\d{3})(\d{3})(\d)+$/,"($1)$2-$3"))}),navigationButtons(),goToPage(),pages(),keylisteners()});var loginAttempt=0;$(document).ready(function(){}),$(document).ready(function(){$(".locationInput").hide(),$(".locationLink").html("Finding Location..."),$(".locationInput").on("keyup",function(a){validateInput($(this).val(),a)}),locationLink=$(".locationLink"),geolocation()}),$(document).ready(function(){$(".uf-textfield__input").on("focusin",function(){$(this).parent().addClass("is-focused")}),$(".uf-textfield__input").on("focusout",function(){null!=$(this).val()&&""!=$(this).val().trim()||$(this).parent().removeClass("is-focused")})}),$(document).ready(function(){window.location.href.indexOf("userHome")<-1&&(topTermsChart(),searchCountChart(),platformChart())});var limit=25,page=1,offset="0";$(document).ready(function(){$(".loadmore-button").hide(),$(".navbar-normal").hide()}),$(document).ready(function(){$(".explain").hide(),$("select[name=referral]").select2({width:"fit-content"}),$("select[name=referral]").on("change",function(){"Other"===$(this).val()?$(".explain").fadeIn(250):$(".explain").hide()})});